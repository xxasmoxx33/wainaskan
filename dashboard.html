<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - ÙˆÙŠÙ† Ø£Ø³ÙƒÙ†</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #0a1628, #132a13, #1a2332);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ===== SCROLLBAR ===== */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.12); border-radius: 6px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2); }

        /* ===== LOGIN OVERLAY ===== */
        .login-overlay {
            position: fixed;
            inset: 0;
            z-index: 9999;
            background: linear-gradient(135deg, #0a1628, #132a13, #1a2332);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s, visibility 0.5s;
        }

        .login-overlay.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .login-card {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 24px;
            padding: 48px 40px;
            width: 100%;
            max-width: 420px;
            margin: 20px;
            text-align: center;
            animation: loginReveal 0.6s ease;
        }

        @keyframes loginReveal {
            from { opacity: 0; transform: scale(0.92) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .login-logo {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            margin: 0 auto 20px;
            box-shadow: 0 8px 30px rgba(16, 185, 129, 0.3);
        }

        .login-title {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 6px;
            background: linear-gradient(135deg, #10b981, #6ee7b7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .login-subtitle {
            font-size: 14px;
            color: rgba(255,255,255,0.45);
            margin-bottom: 32px;
        }

        .login-input-wrap {
            position: relative;
            margin-bottom: 20px;
        }

        .login-input {
            width: 100%;
            padding: 16px 20px;
            padding-inline-start: 48px;
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.12);
            border-radius: 14px;
            color: #fff;
            font-family: 'Cairo', sans-serif;
            font-size: 15px;
            outline: none;
            transition: all 0.3s;
        }

        .login-input:focus {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.08);
        }

        .login-input::placeholder { color: rgba(255,255,255,0.3); }

        .login-input-icon {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            inset-inline-start: 16px;
            font-size: 18px;
            opacity: 0.4;
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            border-radius: 14px;
            color: #fff;
            font-family: 'Cairo', sans-serif;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .login-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(16, 185, 129, 0.4); }
        .login-btn:active { transform: translateY(0); }

        .login-error {
            color: #f87171;
            font-size: 13px;
            margin-top: 12px;
            min-height: 20px;
        }

        /* ===== NAV ===== */
        .nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 28px;
            background: rgba(255,255,255,0.03);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255,255,255,0.08);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .nav-logo {
            width: 38px;
            height: 38px;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .nav-title {
            font-size: 18px;
            font-weight: 800;
            background: linear-gradient(135deg, #10b981, #6ee7b7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-badge {
            background: rgba(16, 185, 129, 0.15);
            color: #10b981;
            font-size: 12px;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 50px;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn {
            padding: 8px 16px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.12);
            background: rgba(255,255,255,0.05);
            color: rgba(255,255,255,0.6);
            font-family: 'Cairo', sans-serif;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .nav-btn:hover { background: rgba(255,255,255,0.1); color: #fff; }

        .lang-btn { border-radius: 50px; }
        .lang-btn.active {
            background: linear-gradient(135deg, #10b981, #059669);
            border-color: transparent;
            color: #fff;
        }

        /* ===== MAIN CONTENT ===== */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px 28px 60px;
        }

        /* ===== STATS ROW ===== */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: rgba(255,255,255,0.04);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 18px;
            padding: 20px 22px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            inset-inline-start: 0;
            width: 4px;
            height: 100%;
            border-radius: 0 4px 4px 0;
        }

        .stat-card:nth-child(1)::before { background: linear-gradient(180deg, #10b981, #059669); }
        .stat-card:nth-child(2)::before { background: linear-gradient(180deg, #3b82f6, #1d4ed8); }
        .stat-card:nth-child(3)::before { background: linear-gradient(180deg, #f59e0b, #d97706); }
        .stat-card:nth-child(4)::before { background: linear-gradient(180deg, #8b5cf6, #6d28d9); }

        .stat-card:hover { transform: translateY(-3px); border-color: rgba(255,255,255,0.15); }

        .stat-icon {
            width: 44px;
            height: 44px;
            border-radius: 13px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            margin-bottom: 14px;
        }

        .stat-card:nth-child(1) .stat-icon { background: rgba(16, 185, 129, 0.12); }
        .stat-card:nth-child(2) .stat-icon { background: rgba(59, 130, 246, 0.12); }
        .stat-card:nth-child(3) .stat-icon { background: rgba(245, 158, 11, 0.12); }
        .stat-card:nth-child(4) .stat-icon { background: rgba(139, 92, 246, 0.12); }

        .stat-value {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 2px;
            line-height: 1.2;
        }

        .stat-card:nth-child(1) .stat-value { color: #10b981; }
        .stat-card:nth-child(2) .stat-value { color: #3b82f6; }
        .stat-card:nth-child(3) .stat-value { color: #f59e0b; }
        .stat-card:nth-child(4) .stat-value { color: #8b5cf6; }

        .stat-label {
            font-size: 13px;
            color: rgba(255,255,255,0.45);
            font-weight: 600;
        }

        /* ===== FILTERS BAR ===== */
        .filters-bar {
            background: rgba(255,255,255,0.04);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 18px;
            padding: 18px 22px;
            margin-bottom: 24px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 12px;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-label {
            font-size: 12px;
            font-weight: 700;
            color: rgba(255,255,255,0.4);
            white-space: nowrap;
        }

        .filter-input, .filter-select {
            padding: 9px 14px;
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            color: #fff;
            font-family: 'Cairo', sans-serif;
            font-size: 13px;
            outline: none;
            transition: all 0.3s;
        }

        .filter-input:focus, .filter-select:focus {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.08);
        }

        .filter-select {
            -webkit-appearance: none;
            appearance: none;
            padding-inline-end: 32px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='rgba(255,255,255,0.4)' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: left 10px center;
            cursor: pointer;
        }

        [dir="ltr"] .filter-select { background-position: right 10px center; }

        .filter-select option { background: #1a2332; color: #fff; }

        .filter-input[type="date"] {
            min-width: 140px;
        }

        .filter-input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1) opacity(0.4);
            cursor: pointer;
        }

        .filters-actions {
            margin-inline-start: auto;
            display: flex;
            gap: 8px;
        }

        .btn-filter-action {
            padding: 9px 18px;
            border-radius: 10px;
            border: none;
            font-family: 'Cairo', sans-serif;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn-reset {
            background: rgba(255,255,255,0.06);
            color: rgba(255,255,255,0.6);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .btn-reset:hover { background: rgba(255,255,255,0.1); color: #fff; }

        .btn-export {
            background: linear-gradient(135deg, #10b981, #059669);
            color: #fff;
        }
        .btn-export:hover { transform: translateY(-1px); box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3); }

        .btn-demo {
            background: rgba(245, 158, 11, 0.15);
            color: #f59e0b;
            border: 1px solid rgba(245, 158, 11, 0.25);
        }
        .btn-demo:hover { background: rgba(245, 158, 11, 0.25); }

        /* ===== RESULTS COUNT ===== */
        .results-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
            padding: 0 4px;
        }

        .results-count {
            font-size: 14px;
            color: rgba(255,255,255,0.5);
            font-weight: 600;
        }

        .results-count span { color: #10b981; font-weight: 800; }

        /* ===== TABLE CONTAINER ===== */
        .table-container {
            background: rgba(255,255,255,0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 18px;
            overflow: hidden;
        }

        .table-scroll {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1100px;
        }

        thead th {
            padding: 14px 16px;
            text-align: start;
            font-size: 12px;
            font-weight: 700;
            color: rgba(255,255,255,0.4);
            background: rgba(255,255,255,0.03);
            border-bottom: 1px solid rgba(255,255,255,0.08);
            white-space: nowrap;
            position: sticky;
            top: 0;
        }

        tbody tr {
            transition: background 0.2s;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        tbody tr:hover { background: rgba(16, 185, 129, 0.04); }
        tbody tr:last-child { border-bottom: none; }

        tbody td {
            padding: 14px 16px;
            font-size: 13px;
            color: rgba(255,255,255,0.8);
            white-space: nowrap;
        }

        .td-phone {
            direction: ltr;
            text-align: end;
            font-weight: 700;
            color: #10b981;
            letter-spacing: 0.5px;
        }

        .td-neighborhood {
            font-weight: 700;
            color: #fff;
        }

        .td-notes {
            max-width: 180px;
            white-space: normal;
            line-height: 1.5;
            font-size: 12px;
            color: rgba(255,255,255,0.55);
        }

        /* ===== STATUS BADGES ===== */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 5px 14px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 700;
            white-space: nowrap;
        }

        .status-new {
            background: rgba(250, 204, 21, 0.12);
            color: #facc15;
            border: 1px solid rgba(250, 204, 21, 0.2);
        }

        .status-contacted {
            background: rgba(59, 130, 246, 0.12);
            color: #60a5fa;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .status-done {
            background: rgba(16, 185, 129, 0.12);
            color: #34d399;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        /* ===== STATUS DROPDOWN ===== */
        .status-select-wrap {
            position: relative;
        }

        .status-select {
            -webkit-appearance: none;
            appearance: none;
            border: none;
            outline: none;
            font-family: 'Cairo', sans-serif;
            font-size: 12px;
            font-weight: 700;
            padding: 6px 28px 6px 14px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 24 24' fill='none' stroke='rgba(255,255,255,0.5)' stroke-width='2.5'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: left 8px center;
        }

        [dir="ltr"] .status-select { background-position: right 8px center; padding: 6px 14px 6px 28px; }

        .status-select option { background: #1a2332; color: #fff; }

        .status-select.s-new {
            background-color: rgba(250, 204, 21, 0.12);
            color: #facc15;
            border: 1px solid rgba(250, 204, 21, 0.2);
        }

        .status-select.s-contacted {
            background-color: rgba(59, 130, 246, 0.12);
            color: #60a5fa;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .status-select.s-done {
            background-color: rgba(16, 185, 129, 0.12);
            color: #34d399;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        /* ===== ACTION BUTTONS ===== */
        .action-btns {
            display: flex;
            gap: 4px;
        }

        .action-btn {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.08);
            background: rgba(255,255,255,0.04);
            color: rgba(255,255,255,0.5);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-btn:hover { background: rgba(255,255,255,0.1); color: #fff; }

        .action-btn.btn-call:hover { background: rgba(59, 130, 246, 0.2); color: #60a5fa; }
        .action-btn.btn-done-action:hover { background: rgba(16, 185, 129, 0.2); color: #34d399; }
        .action-btn.btn-export-single:hover { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }

        /* ===== EMPTY STATE ===== */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: 20px;
            animation: emptyBounce 2s ease infinite;
        }

        @keyframes emptyBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .empty-title {
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 8px;
            color: rgba(255,255,255,0.7);
        }

        .empty-desc {
            font-size: 14px;
            color: rgba(255,255,255,0.4);
            max-width: 400px;
            margin: 0 auto;
            line-height: 1.7;
        }

        /* ===== TOAST ===== */
        .toast {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            background: rgba(10, 22, 15, 0.95);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 14px;
            padding: 14px 24px;
            font-size: 14px;
            font-weight: 600;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            pointer-events: none;
            z-index: 999;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 1024px) {
            .stats-row { grid-template-columns: repeat(2, 1fr); }
            .filters-bar { flex-direction: column; align-items: stretch; }
            .filters-actions { margin-inline-start: 0; justify-content: flex-end; }
            .filter-group { flex-wrap: wrap; }
        }

        @media (max-width: 640px) {
            .nav { padding: 10px 16px; }
            .main-content { padding: 16px; }
            .stats-row { grid-template-columns: 1fr 1fr; gap: 10px; }
            .stat-card { padding: 16px; }
            .stat-value { font-size: 22px; }
            .stat-icon { width: 36px; height: 36px; font-size: 18px; margin-bottom: 10px; }
            .nav-badge { display: none; }
            .login-card { padding: 32px 24px; }
            .filters-bar { padding: 14px 16px; gap: 10px; }
            .filter-input, .filter-select { font-size: 12px; padding: 8px 10px; }
        }

        @media (max-width: 400px) {
            .stats-row { grid-template-columns: 1fr; }
        }

        /* ===== PROPERTY/PURPOSE BADGES ===== */
        .prop-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 3px 10px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.08);
        }

        .purpose-buy {
            background: rgba(16, 185, 129, 0.1);
            color: #34d399;
            border-color: rgba(16, 185, 129, 0.15);
        }

        .purpose-rent {
            background: rgba(139, 92, 246, 0.1);
            color: #a78bfa;
            border-color: rgba(139, 92, 246, 0.15);
        }

        /* ===== MOBILE CARDS (for small screens) ===== */
        .mobile-cards { display: none; }

        @media (max-width: 900px) {
            .table-container { display: none; }
            .mobile-cards { display: block; }

            .lead-card {
                background: rgba(255,255,255,0.04);
                backdrop-filter: blur(20px);
                border: 1px solid rgba(255,255,255,0.08);
                border-radius: 16px;
                padding: 18px;
                margin-bottom: 12px;
                transition: all 0.3s;
            }

            .lead-card:hover { border-color: rgba(16, 185, 129, 0.2); }

            .lead-card-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 14px;
            }

            .lead-card-phone {
                direction: ltr;
                font-size: 15px;
                font-weight: 800;
                color: #10b981;
            }

            .lead-card-date {
                font-size: 11px;
                color: rgba(255,255,255,0.35);
            }

            .lead-card-body {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 10px;
                margin-bottom: 14px;
            }

            .lead-card-field {
                display: flex;
                flex-direction: column;
                gap: 2px;
            }

            .lead-card-field-label {
                font-size: 11px;
                color: rgba(255,255,255,0.35);
                font-weight: 600;
            }

            .lead-card-field-value {
                font-size: 13px;
                color: rgba(255,255,255,0.85);
                font-weight: 600;
            }

            .lead-card-notes {
                background: rgba(255,255,255,0.03);
                border-radius: 10px;
                padding: 10px 12px;
                font-size: 12px;
                color: rgba(255,255,255,0.5);
                line-height: 1.6;
                margin-bottom: 14px;
            }

            .lead-card-footer {
                display: flex;
                align-items: center;
                justify-content: space-between;
                gap: 8px;
            }

            .lead-card-actions {
                display: flex;
                gap: 6px;
            }

            .lead-card-actions .action-btn {
                width: 36px;
                height: 36px;
                font-size: 16px;
            }
        }

        /* ===== ANIMATIONS ===== */
        .fade-in {
            animation: fadeInUp 0.4s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(12px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .table-row-anim {
            animation: rowSlide 0.3s ease;
        }

        @keyframes rowSlide {
            from { opacity: 0; transform: translateX(10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Pulse for new status */
        @keyframes pulse-yellow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(250, 204, 21, 0.3); }
            50% { box-shadow: 0 0 0 6px rgba(250, 204, 21, 0); }
        }

        .status-new { animation: pulse-yellow 2.5s ease infinite; }

    </style>
</head>
<body>

    <!-- ===== LOGIN OVERLAY ===== -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-card">
            <div class="login-logo">ğŸ”</div>
            <div class="login-title" data-ar="Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…" data-en="Dashboard">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</div>
            <div class="login-subtitle" data-ar="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„ÙˆØµÙˆÙ„" data-en="Enter password to access">Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„ÙˆØµÙˆÙ„</div>
            <div class="login-input-wrap">
                <span class="login-input-icon">ğŸ”‘</span>
                <input type="password" class="login-input" id="loginPassword"
                    placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
                    data-ar-ph="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
                    data-en-ph="Password"
                    onkeydown="if(event.key==='Enter') attemptLogin()">
            </div>
            <button class="login-btn" onclick="attemptLogin()">
                <span data-ar="Ø¯Ø®ÙˆÙ„" data-en="Login">Ø¯Ø®ÙˆÙ„</span>
                <span>â†</span>
            </button>
            <div class="login-error" id="loginError"></div>
        </div>
    </div>

    <!-- ===== MAIN APP ===== -->
    <div id="appContent" style="display:none;">

        <!-- NAV -->
        <nav class="nav">
            <div class="nav-right">
                <div class="nav-logo">ğŸ“Š</div>
                <span class="nav-title" data-ar="ÙˆÙŠÙ† Ø£Ø³ÙƒÙ†" data-en="Wain Askan">ÙˆÙŠÙ† Ø£Ø³ÙƒÙ†</span>
                <span class="nav-badge" data-ar="Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…" data-en="Dashboard">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
            </div>
            <div class="nav-left">
                <button class="nav-btn lang-btn active" id="langAr" onclick="setLang('ar')">Ø¹Ø±Ø¨ÙŠ</button>
                <button class="nav-btn lang-btn" id="langEn" onclick="setLang('en')">EN</button>
                <button class="nav-btn" onclick="refreshData()" title="ØªØ­Ø¯ÙŠØ«">ğŸ”„</button>
                <button class="nav-btn" onclick="logout()">
                    <span>ğŸšª</span>
                    <span data-ar="Ø®Ø±ÙˆØ¬" data-en="Logout">Ø®Ø±ÙˆØ¬</span>
                </button>
            </div>
        </nav>

        <!-- MAIN -->
        <div class="main-content">

            <!-- STATS -->
            <div class="stats-row fade-in" id="statsRow">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“‹</div>
                    <div class="stat-value" id="statTotal">0</div>
                    <div class="stat-label" data-ar="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª" data-en="Total Requests">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“…</div>
                    <div class="stat-value" id="statToday">0</div>
                    <div class="stat-label" data-ar="Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…" data-en="Today's Requests">Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ </div>
                    <div class="stat-value" id="statTopType">â€”</div>
                    <div class="stat-label" data-ar="Ø£ÙƒØ«Ø± Ù†ÙˆØ¹ Ø¹Ù‚Ø§Ø± Ù…Ø·Ù„ÙˆØ¨" data-en="Most Requested Type">Ø£ÙƒØ«Ø± Ù†ÙˆØ¹ Ø¹Ù‚Ø§Ø± Ù…Ø·Ù„ÙˆØ¨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“</div>
                    <div class="stat-value" id="statTopArea" style="font-size:18px;">â€”</div>
                    <div class="stat-label" data-ar="Ø£ÙƒØ«Ø± Ø­ÙŠ Ù…Ø·Ù„ÙˆØ¨" data-en="Most Requested Area">Ø£ÙƒØ«Ø± Ø­ÙŠ Ù…Ø·Ù„ÙˆØ¨</div>
                </div>
            </div>

            <!-- FILTERS -->
            <div class="filters-bar fade-in">
                <div class="filter-group">
                    <span class="filter-label" data-ar="Ù…Ù†:" data-en="From:">Ù…Ù†:</span>
                    <input type="date" class="filter-input" id="filterDateFrom" onchange="applyFilters()">
                </div>
                <div class="filter-group">
                    <span class="filter-label" data-ar="Ø¥Ù„Ù‰:" data-en="To:">Ø¥Ù„Ù‰:</span>
                    <input type="date" class="filter-input" id="filterDateTo" onchange="applyFilters()">
                </div>
                <div class="filter-group">
                    <span class="filter-label" data-ar="Ø§Ù„Ù†ÙˆØ¹:" data-en="Type:">Ø§Ù„Ù†ÙˆØ¹:</span>
                    <select class="filter-select" id="filterType" onchange="applyFilters()">
                        <option value="" data-ar="Ø§Ù„ÙƒÙ„" data-en="All">Ø§Ù„ÙƒÙ„</option>
                        <option value="land" data-ar="Ø£Ø±Ø¶" data-en="Land">Ø£Ø±Ø¶</option>
                        <option value="villa" data-ar="ÙÙŠÙ„Ø§" data-en="Villa">ÙÙŠÙ„Ø§</option>
                        <option value="apartment" data-ar="Ø´Ù‚Ø©" data-en="Apartment">Ø´Ù‚Ø©</option>
                        <option value="duplex" data-ar="Ø¯Ø¨Ù„ÙƒØ³" data-en="Duplex">Ø¯Ø¨Ù„ÙƒØ³</option>
                        <option value="floor" data-ar="Ø¯ÙˆØ±" data-en="Floor">Ø¯ÙˆØ±</option>
                        <option value="townhouse" data-ar="ØªØ§ÙˆÙ† Ù‡Ø§ÙˆØ³" data-en="Townhouse">ØªØ§ÙˆÙ† Ù‡Ø§ÙˆØ³</option>
                    </select>
                </div>
                <div class="filter-group">
                    <span class="filter-label" data-ar="Ø§Ù„ØºØ±Ø¶:" data-en="Purpose:">Ø§Ù„ØºØ±Ø¶:</span>
                    <select class="filter-select" id="filterPurpose" onchange="applyFilters()">
                        <option value="" data-ar="Ø§Ù„ÙƒÙ„" data-en="All">Ø§Ù„ÙƒÙ„</option>
                        <option value="buy" data-ar="Ø´Ø±Ø§Ø¡" data-en="Buy">Ø´Ø±Ø§Ø¡</option>
                        <option value="rent" data-ar="Ø¥ÙŠØ¬Ø§Ø±" data-en="Rent">Ø¥ÙŠØ¬Ø§Ø±</option>
                    </select>
                </div>
                <div class="filter-group">
                    <span class="filter-label" data-ar="Ø§Ù„Ø­Ø§Ù„Ø©:" data-en="Status:">Ø§Ù„Ø­Ø§Ù„Ø©:</span>
                    <select class="filter-select" id="filterStatus" onchange="applyFilters()">
                        <option value="" data-ar="Ø§Ù„ÙƒÙ„" data-en="All">Ø§Ù„ÙƒÙ„</option>
                        <option value="new" data-ar="Ø¬Ø¯ÙŠØ¯" data-en="New">Ø¬Ø¯ÙŠØ¯</option>
                        <option value="contacted" data-ar="ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„" data-en="Contacted">ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„</option>
                        <option value="done" data-ar="Ù…ÙƒØªÙ…Ù„" data-en="Done">Ù…ÙƒØªÙ…Ù„</option>
                    </select>
                </div>
                <div class="filters-actions">
                    <button class="btn-filter-action btn-demo" onclick="loadDemoData()">
                        <span>ğŸ§ª</span>
                        <span data-ar="Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©" data-en="Demo Data">Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©</span>
                    </button>
                    <button class="btn-filter-action btn-reset" onclick="resetFilters()">
                        <span>âœ•</span>
                        <span data-ar="Ù…Ø³Ø­" data-en="Reset">Ù…Ø³Ø­</span>
                    </button>
                    <button class="btn-filter-action btn-export" onclick="exportCSV()">
                        <span>ğŸ“¥</span>
                        <span data-ar="ØªØµØ¯ÙŠØ± CSV" data-en="Export CSV">ØªØµØ¯ÙŠØ± CSV</span>
                    </button>
                </div>
            </div>

            <!-- RESULTS INFO -->
            <div class="results-info" id="resultsInfo" style="display:none;">
                <div class="results-count">
                    <span data-ar="Ø¹Ø±Ø¶" data-en="Showing">Ø¹Ø±Ø¶</span>
                    <span id="filteredCount">0</span>
                    <span data-ar="Ù…Ù† Ø£ØµÙ„" data-en="of">Ù…Ù† Ø£ØµÙ„</span>
                    <span id="totalCount">0</span>
                    <span data-ar="Ø·Ù„Ø¨" data-en="requests">Ø·Ù„Ø¨</span>
                </div>
            </div>

            <!-- TABLE (Desktop) -->
            <div class="table-container fade-in" id="tableContainer" style="display:none;">
                <div class="table-scroll">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th data-ar="Ø§Ù„ØªØ§Ø±ÙŠØ®" data-en="Date">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th data-ar="Ø§Ù„Ø¬ÙˆØ§Ù„" data-en="Phone">Ø§Ù„Ø¬ÙˆØ§Ù„</th>
                                <th data-ar="Ø§Ù„Ø­ÙŠ" data-en="Neighborhood">Ø§Ù„Ø­ÙŠ</th>
                                <th data-ar="Ø§Ù„Ù†ÙˆØ¹" data-en="Type">Ø§Ù„Ù†ÙˆØ¹</th>
                                <th data-ar="Ø§Ù„ØºØ±Ø¶" data-en="Purpose">Ø§Ù„ØºØ±Ø¶</th>
                                <th data-ar="Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©" data-en="Budget">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</th>
                                <th data-ar="Ø§Ù„ØºØ±Ù" data-en="Rooms">Ø§Ù„ØºØ±Ù</th>
                                <th data-ar="Ø§Ù„Ø£Ø³Ø±Ø©" data-en="Family">Ø§Ù„Ø£Ø³Ø±Ø©</th>
                                <th data-ar="Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„" data-en="Timeline">Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„</th>
                                <th data-ar="Ù…Ù„Ø§Ø­Ø¸Ø§Øª" data-en="Notes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
                                <th data-ar="Ø§Ù„Ø­Ø§Ù„Ø©" data-en="Status">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th data-ar="Ø¥Ø¬Ø±Ø§Ø¡" data-en="Actions">Ø¥Ø¬Ø±Ø§Ø¡</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- MOBILE CARDS -->
            <div class="mobile-cards" id="mobileCards"></div>

            <!-- EMPTY STATE -->
            <div class="empty-state fade-in" id="emptyState" style="display:none;">
                <div class="empty-icon">ğŸ“­</div>
                <div class="empty-title" data-ar="Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª" data-en="No Requests Yet">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª</div>
                <div class="empty-desc" data-ar="Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø£ÙŠ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯. Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù‡Ù†Ø§ Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ±Ø³Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡Ù… Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ." data-en="No requests received yet. Requests will appear here when clients submit their data from the main site.">Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø£ÙŠ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯. Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù‡Ù†Ø§ Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ±Ø³Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡Ù… Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ.</div>
                <br>
                <button class="btn-filter-action btn-demo" onclick="loadDemoData()" style="margin:0 auto;">
                    <span>ğŸ§ª</span>
                    <span data-ar="Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©" data-en="Add demo data for preview">Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©</span>
                </button>
            </div>

        </div>
    </div>

    <!-- TOAST -->
    <div class="toast" id="toast"></div>

    <script>
        // ===== GLOBALS =====
        let lang = 'ar';
        let allLeads = [];
        let filteredLeads = [];

        // SHA-256 of "admin123" - precomputed
        const DEFAULT_PASS_HASH = '240be518fabd2724ddb6f04eeb9d56b5714a3e2568b2c4c349155b9b1b3a3bf1';
        let defaultHashReady = false;

        // SHA-256 hashing
        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        // Compute real default hash on init and store it
        async function initDefaultHash() {
            const realHash = await sha256('admin123');
            if (!localStorage.getItem('wainaskan_dash_pass')) {
                localStorage.setItem('wainaskan_dash_pass', realHash);
            }
            defaultHashReady = true;
            return realHash;
        }

        // ===== AUTH =====
        async function attemptLogin() {
            const password = document.getElementById('loginPassword').value;
            const errorEl = document.getElementById('loginError');

            if (!password) {
                errorEl.textContent = lang === 'ar' ? 'Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±' : 'Enter password';
                return;
            }

            const hash = await sha256(password);
            const storedHash = localStorage.getItem('wainaskan_dash_pass');
            const defaultHash = await sha256('admin123');

            // Check against stored hash or default password
            if (hash === storedHash || hash === defaultHash) {
                if (!storedHash) {
                    localStorage.setItem('wainaskan_dash_pass', defaultHash);
                }
                sessionStorage.setItem('wainaskan_dash_auth', 'true');
                document.getElementById('loginOverlay').classList.add('hidden');
                document.getElementById('appContent').style.display = 'block';
                loadData();
            } else {
                errorEl.textContent = lang === 'ar' ? 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©' : 'Incorrect password';
                document.getElementById('loginPassword').value = '';
                document.getElementById('loginPassword').focus();
            }
        }

        function logout() {
            sessionStorage.removeItem('wainaskan_dash_auth');
            document.getElementById('loginOverlay').classList.remove('hidden');
            document.getElementById('appContent').style.display = 'none';
            document.getElementById('loginPassword').value = '';
        }

        function checkAuth() {
            if (sessionStorage.getItem('wainaskan_dash_auth') === 'true') {
                document.getElementById('loginOverlay').classList.add('hidden');
                document.getElementById('appContent').style.display = 'block';
                loadData();
            }
        }

        // ===== DATA =====
        function loadData() {
            try {
                allLeads = JSON.parse(localStorage.getItem('wainaskan_leads') || '[]');
            } catch (e) {
                allLeads = [];
            }
            applyFilters();
            updateStats();
        }

        function refreshData() {
            loadData();
            showToast(lang === 'ar' ? 'ğŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª' : 'ğŸ”„ Data refreshed');
        }

        function saveLeads() {
            localStorage.setItem('wainaskan_leads', JSON.stringify(allLeads));
        }

        function updateStatus(leadId, newStatus) {
            const lead = allLeads.find(l => l.id === leadId);
            if (lead) {
                lead.status = newStatus;
                saveLeads();
                applyFilters();
                updateStats();
                const msgs = {
                    new: lang === 'ar' ? 'ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©: Ø¬Ø¯ÙŠØ¯' : 'Status: New',
                    contacted: lang === 'ar' ? 'ğŸ“ ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©: ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„' : 'ğŸ“ Status: Contacted',
                    done: lang === 'ar' ? 'âœ… ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©: Ù…ÙƒØªÙ…Ù„' : 'âœ… Status: Done'
                };
                showToast(msgs[newStatus] || '');
            }
        }

        // ===== FILTERS =====
        function applyFilters() {
            const dateFrom = document.getElementById('filterDateFrom').value;
            const dateTo = document.getElementById('filterDateTo').value;
            const type = document.getElementById('filterType').value;
            const purpose = document.getElementById('filterPurpose').value;
            const status = document.getElementById('filterStatus').value;

            filteredLeads = allLeads.filter(lead => {
                // Date filter
                if (dateFrom) {
                    const leadDate = lead.timestamp ? lead.timestamp.split('T')[0] : '';
                    if (leadDate < dateFrom) return false;
                }
                if (dateTo) {
                    const leadDate = lead.timestamp ? lead.timestamp.split('T')[0] : '';
                    if (leadDate > dateTo) return false;
                }
                // Type
                if (type && lead.propertyType !== type) return false;
                // Purpose
                if (purpose && lead.purpose !== purpose) return false;
                // Status
                if (status && lead.status !== status) return false;

                return true;
            });

            renderTable();
            renderMobileCards();
        }

        function resetFilters() {
            document.getElementById('filterDateFrom').value = '';
            document.getElementById('filterDateTo').value = '';
            document.getElementById('filterType').value = '';
            document.getElementById('filterPurpose').value = '';
            document.getElementById('filterStatus').value = '';
            applyFilters();
        }

        // ===== STATS =====
        function updateStats() {
            // Total
            document.getElementById('statTotal').textContent = allLeads.length;

            // Today
            const today = new Date().toISOString().split('T')[0];
            const todayCount = allLeads.filter(l => l.timestamp && l.timestamp.startsWith(today)).length;
            document.getElementById('statToday').textContent = todayCount;

            // Most requested property type
            if (allLeads.length > 0) {
                const typeCounts = {};
                allLeads.forEach(l => {
                    if (l.propertyType) typeCounts[l.propertyType] = (typeCounts[l.propertyType] || 0) + 1;
                });
                const topType = Object.entries(typeCounts).sort((a, b) => b[1] - a[1])[0];
                document.getElementById('statTopType').textContent = topType ? getPropertyLabel(topType[0]) : 'â€”';

                // Most requested area
                const areaCounts = {};
                allLeads.forEach(l => {
                    if (l.neighborhood) areaCounts[l.neighborhood] = (areaCounts[l.neighborhood] || 0) + 1;
                });
                const topArea = Object.entries(areaCounts).sort((a, b) => b[1] - a[1])[0];
                document.getElementById('statTopArea').textContent = topArea ? topArea[0] : 'â€”';
            } else {
                document.getElementById('statTopType').textContent = 'â€”';
                document.getElementById('statTopArea').textContent = 'â€”';
            }
        }

        // ===== LABELS / MAPPING =====
        const propertyLabels = {
            ar: { land: 'Ø£Ø±Ø¶', villa: 'ÙÙŠÙ„Ø§', apartment: 'Ø´Ù‚Ø©', duplex: 'Ø¯Ø¨Ù„ÙƒØ³', floor: 'Ø¯ÙˆØ±', townhouse: 'ØªØ§ÙˆÙ† Ù‡Ø§ÙˆØ³' },
            en: { land: 'Land', villa: 'Villa', apartment: 'Apartment', duplex: 'Duplex', floor: 'Floor', townhouse: 'Townhouse' }
        };

        const propertyIcons = { land: 'ğŸ—ï¸', villa: 'ğŸ¡', apartment: 'ğŸ¢', duplex: 'ğŸ˜ï¸', floor: 'ğŸ ', townhouse: 'ğŸšï¸' };

        const purposeLabels = {
            ar: { buy: 'Ø´Ø±Ø§Ø¡', rent: 'Ø¥ÙŠØ¬Ø§Ø±' },
            en: { buy: 'Buy', rent: 'Rent' }
        };

        const budgetLabels = {
            ar: {
                'under500k': 'Ø£Ù‚Ù„ Ù…Ù† 500 Ø£Ù„Ù', '500k-1m': '500 Ø£Ù„Ù - 1 Ù…Ù„ÙŠÙˆÙ†',
                '1m-1.5m': '1 - 1.5 Ù…Ù„ÙŠÙˆÙ†', '1.5m-2m': '1.5 - 2 Ù…Ù„ÙŠÙˆÙ†',
                '2m-3m': '2 - 3 Ù…Ù„ÙŠÙˆÙ†', 'above3m': 'Ø£ÙƒØ«Ø± Ù…Ù† 3 Ù…Ù„ÙŠÙˆÙ†',
                'under2k': 'Ø£Ù‚Ù„ Ù…Ù† 2,000 Ø±.Ø³', '2k-3k': '2,000 - 3,000 Ø±.Ø³',
                '3k-5k': '3,000 - 5,000 Ø±.Ø³', '5k-8k': '5,000 - 8,000 Ø±.Ø³',
                '8k-12k': '8,000 - 12,000 Ø±.Ø³', 'above12k': 'Ø£ÙƒØ«Ø± Ù…Ù† 12,000 Ø±.Ø³'
            },
            en: {
                'under500k': '<500K', '500k-1m': '500K-1M',
                '1m-1.5m': '1M-1.5M', '1.5m-2m': '1.5M-2M',
                '2m-3m': '2M-3M', 'above3m': '>3M',
                'under2k': '<2K SAR/mo', '2k-3k': '2-3K SAR/mo',
                '3k-5k': '3-5K SAR/mo', '5k-8k': '5-8K SAR/mo',
                '8k-12k': '8-12K SAR/mo', 'above12k': '>12K SAR/mo'
            }
        };

        const familyLabels = {
            ar: { '1-2': '1-2 Ø£ÙØ±Ø§Ø¯', '3-4': '3-4 Ø£ÙØ±Ø§Ø¯', '5-6': '5-6 Ø£ÙØ±Ø§Ø¯', '7+': '7+ Ø£ÙØ±Ø§Ø¯' },
            en: { '1-2': '1-2', '3-4': '3-4', '5-6': '5-6', '7+': '7+' }
        };

        const timelineLabels = {
            ar: { asap: 'ÙÙŠ Ø£Ù‚Ø±Ø¨ ÙˆÙ‚Øª', '1-3months': '1-3 Ø£Ø´Ù‡Ø±', '3-6months': '3-6 Ø£Ø´Ù‡Ø±', exploring: 'ÙŠØ³ØªÙƒØ´Ù' },
            en: { asap: 'ASAP', '1-3months': '1-3 mo', '3-6months': '3-6 mo', exploring: 'Exploring' }
        };

        const statusLabels = {
            ar: { new: 'Ø¬Ø¯ÙŠØ¯', contacted: 'ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„', done: 'Ù…ÙƒØªÙ…Ù„' },
            en: { new: 'New', contacted: 'Contacted', done: 'Done' }
        };

        function getPropertyLabel(type) { return (propertyLabels[lang] || propertyLabels.ar)[type] || type; }
        function getPurposeLabel(p) { return (purposeLabels[lang] || purposeLabels.ar)[p] || p; }
        function getBudgetLabel(b) { return (budgetLabels[lang] || budgetLabels.ar)[b] || b; }
        function getFamilyLabel(f) { return (familyLabels[lang] || familyLabels.ar)[f] || f; }
        function getTimelineLabel(t) { return (timelineLabels[lang] || timelineLabels.ar)[t] || t; }
        function getStatusLabel(s) { return (statusLabels[lang] || statusLabels.ar)[s] || s; }

        // ===== RENDER TABLE =====
        function renderTable() {
            const tbody = document.getElementById('tableBody');
            const empty = document.getElementById('emptyState');
            const table = document.getElementById('tableContainer');
            const info = document.getElementById('resultsInfo');

            if (allLeads.length === 0) {
                table.style.display = 'none';
                info.style.display = 'none';
                empty.style.display = 'block';
                return;
            }

            empty.style.display = 'none';
            table.style.display = 'block';
            info.style.display = 'flex';

            document.getElementById('filteredCount').textContent = filteredLeads.length;
            document.getElementById('totalCount').textContent = allLeads.length;

            tbody.innerHTML = '';

            filteredLeads.forEach((lead, idx) => {
                const tr = document.createElement('tr');
                tr.className = 'table-row-anim';
                tr.style.animationDelay = `${idx * 0.03}s`;

                const dateStr = formatDate(lead.timestamp);
                const statusClass = 's-' + (lead.status || 'new');

                tr.innerHTML = `
                    <td style="color:rgba(255,255,255,0.3);font-size:12px;">${idx + 1}</td>
                    <td style="font-size:12px;color:rgba(255,255,255,0.5);">${dateStr}</td>
                    <td class="td-phone">${lead.phone || 'â€”'}</td>
                    <td class="td-neighborhood">${lead.neighborhood || 'â€”'}</td>
                    <td><span class="prop-badge">${propertyIcons[lead.propertyType] || ''} ${getPropertyLabel(lead.propertyType)}</span></td>
                    <td><span class="prop-badge ${lead.purpose === 'buy' ? 'purpose-buy' : 'purpose-rent'}">${getPurposeLabel(lead.purpose)}</span></td>
                    <td style="font-size:12px;">${getBudgetLabel(lead.budget)}</td>
                    <td style="text-align:center;">${lead.rooms || 'â€”'}</td>
                    <td style="font-size:12px;">${getFamilyLabel(lead.family)}</td>
                    <td style="font-size:12px;">${getTimelineLabel(lead.timeline)}</td>
                    <td class="td-notes">${lead.notes || 'â€”'}</td>
                    <td>
                        <select class="status-select ${statusClass}" onchange="updateStatus('${lead.id}', this.value)">
                            <option value="new" ${lead.status === 'new' ? 'selected' : ''}>${getStatusLabel('new')}</option>
                            <option value="contacted" ${lead.status === 'contacted' ? 'selected' : ''}>${getStatusLabel('contacted')}</option>
                            <option value="done" ${lead.status === 'done' ? 'selected' : ''}>${getStatusLabel('done')}</option>
                        </select>
                    </td>
                    <td>
                        <div class="action-btns">
                            <button class="action-btn btn-call" onclick="updateStatus('${lead.id}','contacted')" title="${lang === 'ar' ? 'ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„' : 'Mark Contacted'}">ğŸ“</button>
                            <button class="action-btn btn-done-action" onclick="updateStatus('${lead.id}','done')" title="${lang === 'ar' ? 'Ù…ÙƒØªÙ…Ù„' : 'Mark Done'}">âœ…</button>
                            <button class="action-btn btn-export-single" onclick="exportSingle('${lead.id}')" title="${lang === 'ar' ? 'ØªØµØ¯ÙŠØ±' : 'Export'}">ğŸ“¤</button>
                        </div>
                    </td>
                `;

                tbody.appendChild(tr);
            });
        }

        // ===== RENDER MOBILE CARDS =====
        function renderMobileCards() {
            const container = document.getElementById('mobileCards');

            if (allLeads.length === 0 || filteredLeads.length === 0) {
                container.innerHTML = '';
                return;
            }

            container.innerHTML = filteredLeads.map((lead, idx) => {
                const dateStr = formatDate(lead.timestamp);
                const statusClass = lead.status || 'new';

                return `
                <div class="lead-card fade-in" style="animation-delay:${idx * 0.05}s">
                    <div class="lead-card-header">
                        <span class="lead-card-phone">${lead.phone || 'â€”'}</span>
                        <span class="lead-card-date">${dateStr}</span>
                    </div>
                    <div class="lead-card-body">
                        <div class="lead-card-field">
                            <span class="lead-card-field-label" data-ar="Ø§Ù„Ø­ÙŠ" data-en="Area">${lang === 'ar' ? 'Ø§Ù„Ø­ÙŠ' : 'Area'}</span>
                            <span class="lead-card-field-value">${lead.neighborhood || 'â€”'}</span>
                        </div>
                        <div class="lead-card-field">
                            <span class="lead-card-field-label" data-ar="Ø§Ù„Ù†ÙˆØ¹" data-en="Type">${lang === 'ar' ? 'Ø§Ù„Ù†ÙˆØ¹' : 'Type'}</span>
                            <span class="lead-card-field-value">${propertyIcons[lead.propertyType] || ''} ${getPropertyLabel(lead.propertyType)}</span>
                        </div>
                        <div class="lead-card-field">
                            <span class="lead-card-field-label" data-ar="Ø§Ù„ØºØ±Ø¶" data-en="Purpose">${lang === 'ar' ? 'Ø§Ù„ØºØ±Ø¶' : 'Purpose'}</span>
                            <span class="lead-card-field-value"><span class="prop-badge ${lead.purpose === 'buy' ? 'purpose-buy' : 'purpose-rent'}">${getPurposeLabel(lead.purpose)}</span></span>
                        </div>
                        <div class="lead-card-field">
                            <span class="lead-card-field-label" data-ar="Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©" data-en="Budget">${lang === 'ar' ? 'Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©' : 'Budget'}</span>
                            <span class="lead-card-field-value">${getBudgetLabel(lead.budget)}</span>
                        </div>
                        <div class="lead-card-field">
                            <span class="lead-card-field-label" data-ar="Ø§Ù„ØºØ±Ù" data-en="Rooms">${lang === 'ar' ? 'Ø§Ù„ØºØ±Ù' : 'Rooms'}</span>
                            <span class="lead-card-field-value">${lead.rooms || 'â€”'}</span>
                        </div>
                        <div class="lead-card-field">
                            <span class="lead-card-field-label" data-ar="Ø§Ù„Ø£Ø³Ø±Ø©" data-en="Family">${lang === 'ar' ? 'Ø§Ù„Ø£Ø³Ø±Ø©' : 'Family'}</span>
                            <span class="lead-card-field-value">${getFamilyLabel(lead.family)}</span>
                        </div>
                        <div class="lead-card-field">
                            <span class="lead-card-field-label" data-ar="Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„" data-en="Timeline">${lang === 'ar' ? 'Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„' : 'Timeline'}</span>
                            <span class="lead-card-field-value">${getTimelineLabel(lead.timeline)}</span>
                        </div>
                    </div>
                    ${lead.notes ? `<div class="lead-card-notes">${lead.notes}</div>` : ''}
                    <div class="lead-card-footer">
                        <select class="status-select s-${statusClass}" onchange="updateStatus('${lead.id}', this.value)">
                            <option value="new" ${lead.status === 'new' ? 'selected' : ''}>${getStatusLabel('new')}</option>
                            <option value="contacted" ${lead.status === 'contacted' ? 'selected' : ''}>${getStatusLabel('contacted')}</option>
                            <option value="done" ${lead.status === 'done' ? 'selected' : ''}>${getStatusLabel('done')}</option>
                        </select>
                        <div class="lead-card-actions">
                            <button class="action-btn btn-call" onclick="updateStatus('${lead.id}','contacted')">ğŸ“</button>
                            <button class="action-btn btn-done-action" onclick="updateStatus('${lead.id}','done')">âœ…</button>
                            <button class="action-btn btn-export-single" onclick="exportSingle('${lead.id}')">ğŸ“¤</button>
                        </div>
                    </div>
                </div>
                `;
            }).join('');
        }

        // ===== FORMAT DATE =====
        function formatDate(timestamp) {
            if (!timestamp) return 'â€”';
            try {
                const d = new Date(timestamp);
                const date = d.toLocaleDateString(lang === 'ar' ? 'ar-SA' : 'en-US', {
                    year: 'numeric', month: 'short', day: 'numeric'
                });
                const time = d.toLocaleTimeString(lang === 'ar' ? 'ar-SA' : 'en-US', {
                    hour: '2-digit', minute: '2-digit'
                });
                return `${date}\n${time}`;
            } catch (e) {
                return timestamp;
            }
        }

        // ===== EXPORT CSV =====
        function exportCSV() {
            if (filteredLeads.length === 0) {
                showToast(lang === 'ar' ? 'âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±' : 'âš ï¸ No data to export');
                return;
            }

            const headers = [
                'ID', lang === 'ar' ? 'Ø§Ù„ØªØ§Ø±ÙŠØ®' : 'Date',
                lang === 'ar' ? 'Ø§Ù„Ø¬ÙˆØ§Ù„' : 'Phone',
                lang === 'ar' ? 'Ø§Ù„Ø­ÙŠ' : 'Neighborhood',
                lang === 'ar' ? 'Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±' : 'Property Type',
                lang === 'ar' ? 'Ø§Ù„ØºØ±Ø¶' : 'Purpose',
                lang === 'ar' ? 'Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©' : 'Budget',
                lang === 'ar' ? 'Ø§Ù„ØºØ±Ù' : 'Rooms',
                lang === 'ar' ? 'Ø­Ø¬Ù… Ø§Ù„Ø£Ø³Ø±Ø©' : 'Family Size',
                lang === 'ar' ? 'Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„' : 'Timeline',
                lang === 'ar' ? 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª' : 'Notes',
                lang === 'ar' ? 'Ø§Ù„Ø­Ø§Ù„Ø©' : 'Status'
            ];

            const rows = filteredLeads.map(l => [
                l.id || '',
                l.timestamp ? new Date(l.timestamp).toLocaleString() : '',
                l.phone || '',
                l.neighborhood || '',
                getPropertyLabel(l.propertyType),
                getPurposeLabel(l.purpose),
                getBudgetLabel(l.budget),
                l.rooms || '',
                getFamilyLabel(l.family),
                getTimelineLabel(l.timeline),
                (l.notes || '').replace(/,/g, 'ØŒ'),
                getStatusLabel(l.status || 'new')
            ]);

            // BOM for Arabic support in Excel
            const BOM = '\uFEFF';
            const csv = BOM + [headers.join(','), ...rows.map(r => r.map(c => `"${c}"`).join(','))].join('\n');

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `wainaskan_leads_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);

            showToast(lang === 'ar' ? `ğŸ“¥ ØªÙ… ØªØµØ¯ÙŠØ± ${filteredLeads.length} Ø·Ù„Ø¨` : `ğŸ“¥ Exported ${filteredLeads.length} requests`);
        }

        function exportSingle(leadId) {
            const lead = allLeads.find(l => l.id === leadId);
            if (!lead) return;

            const lines = [
                `${lang === 'ar' ? 'Ø§Ù„ØªØ§Ø±ÙŠØ®' : 'Date'}: ${lead.timestamp ? new Date(lead.timestamp).toLocaleString() : ''}`,
                `${lang === 'ar' ? 'Ø§Ù„Ø¬ÙˆØ§Ù„' : 'Phone'}: ${lead.phone || ''}`,
                `${lang === 'ar' ? 'Ø§Ù„Ø­ÙŠ' : 'Neighborhood'}: ${lead.neighborhood || ''}`,
                `${lang === 'ar' ? 'Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±' : 'Type'}: ${getPropertyLabel(lead.propertyType)}`,
                `${lang === 'ar' ? 'Ø§Ù„ØºØ±Ø¶' : 'Purpose'}: ${getPurposeLabel(lead.purpose)}`,
                `${lang === 'ar' ? 'Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©' : 'Budget'}: ${getBudgetLabel(lead.budget)}`,
                `${lang === 'ar' ? 'Ø§Ù„ØºØ±Ù' : 'Rooms'}: ${lead.rooms || ''}`,
                `${lang === 'ar' ? 'Ø§Ù„Ø£Ø³Ø±Ø©' : 'Family'}: ${getFamilyLabel(lead.family)}`,
                `${lang === 'ar' ? 'Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„' : 'Timeline'}: ${getTimelineLabel(lead.timeline)}`,
                `${lang === 'ar' ? 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª' : 'Notes'}: ${lead.notes || ''}`,
                `${lang === 'ar' ? 'Ø§Ù„Ø­Ø§Ù„Ø©' : 'Status'}: ${getStatusLabel(lead.status || 'new')}`
            ];

            const blob = new Blob(['\uFEFF' + lines.join('\n')], { type: 'text/plain;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `lead_${lead.phone || lead.id}.txt`;
            a.click();
            URL.revokeObjectURL(url);

            showToast(lang === 'ar' ? 'ğŸ“¤ ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø·Ù„Ø¨' : 'ğŸ“¤ Request exported');
        }

        // ===== DEMO DATA =====
        function loadDemoData() {
            const neighborhoods = ['Ø­ÙŠ Ø§Ù„Ù†Ø±Ø¬Ø³', 'Ø­ÙŠ Ø§Ù„Ù…Ù„Ù‚Ø§', 'Ø­ÙŠ Ø§Ù„Ø¹Ø§Ø±Ø¶', 'Ø­ÙŠ Ø§Ù„ÙŠØ§Ø³Ù…ÙŠÙ†', 'Ø­ÙŠ Ø§Ù„Ù‚ÙŠØ±ÙˆØ§Ù†', 'Ø­ÙŠ Ø§Ù„ØµØ­Ø§ÙØ©', 'Ø­ÙŠ Ø§Ù„Ø±Ø¨ÙŠØ¹', 'Ø­ÙŠ Ø§Ù„Ø¹Ù‚ÙŠÙ‚', 'Ø­ÙŠ Ø§Ù„ØºØ¯ÙŠØ±', 'Ø­ÙŠ Ø§Ù„Ù†Ø®ÙŠÙ„'];
            const types = ['villa', 'apartment', 'duplex', 'land', 'floor', 'townhouse'];
            const purposes = ['buy', 'rent'];
            const buyBudgets = ['under500k', '500k-1m', '1m-1.5m', '1.5m-2m', '2m-3m', 'above3m'];
            const rentBudgets = ['under2k', '2k-3k', '3k-5k', '5k-8k', '8k-12k', 'above12k'];
            const rooms = ['2', '3', '4', '5', '6+'];
            const families = ['1-2', '3-4', '5-6', '7+'];
            const timelines = ['asap', '1-3months', '3-6months', 'exploring'];
            const statuses = ['new', 'new', 'new', 'contacted', 'done'];
            const notes = [
                'Ø£Ø¨ÙŠ Ø¨ÙŠØª Ù‚Ø±ÙŠØ¨ Ù…Ù† Ù…Ø¯Ø±Ø³Ø© Ø£Ù‡Ù„ÙŠØ©',
                'ÙŠÙØ¶Ù„ Ø´Ø§Ø±Ø¹ ØªØ¬Ø§Ø±ÙŠ',
                'Ù…Ø­ØªØ§Ø¬ Ø¬Ø±Ø§Ø¬ Ù„Ø³ÙŠØ§Ø±ØªÙŠÙ†',
                'Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„Ù…Ø³Ø¬Ø¯',
                'ÙŠÙƒÙˆÙ† ÙÙŠÙ‡ Ø­Ø¯ÙŠÙ‚Ø©',
                'Ø·Ø§Ø¨Ù‚ Ø£Ø±Ø¶ÙŠ Ù…Ø¹ Ù…Ø¯Ø®Ù„ Ù…Ø³ØªÙ‚Ù„',
                '',
                'Ù…Ø·Ø¨Ø® ÙˆØ§Ø³Ø¹ ÙˆÙ…Ø¬Ù„Ø³ ÙƒØ¨ÙŠØ±',
                '',
                'Ø£Ø¨ÙŠ Ù…Ø³Ø§Ø­Ø© Ù„Ø§ ØªÙ‚Ù„ Ø¹Ù† 300 Ù…ØªØ±'
            ];

            const demoLeads = [];
            for (let i = 0; i < 15; i++) {
                const purpose = purposes[Math.floor(Math.random() * purposes.length)];
                const budgetList = purpose === 'buy' ? buyBudgets : rentBudgets;
                const daysAgo = Math.floor(Math.random() * 30);
                const ts = new Date(Date.now() - daysAgo * 86400000 - Math.floor(Math.random() * 86400000));

                demoLeads.push({
                    id: 'req_' + (Date.now() - i * 100000 + Math.floor(Math.random() * 10000)),
                    neighborhood: neighborhoods[Math.floor(Math.random() * neighborhoods.length)],
                    propertyType: types[Math.floor(Math.random() * types.length)],
                    purpose: purpose,
                    budget: budgetList[Math.floor(Math.random() * budgetList.length)],
                    rooms: rooms[Math.floor(Math.random() * rooms.length)],
                    family: families[Math.floor(Math.random() * families.length)],
                    timeline: timelines[Math.floor(Math.random() * timelines.length)],
                    notes: notes[Math.floor(Math.random() * notes.length)],
                    phone: '+9665' + Math.floor(10000000 + Math.random() * 90000000),
                    status: statuses[Math.floor(Math.random() * statuses.length)],
                    timestamp: ts.toISOString(),
                    date: ts.toLocaleDateString('ar-SA'),
                    time: ts.toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' })
                });
            }

            // Merge with existing
            allLeads = [...demoLeads, ...allLeads];
            saveLeads();
            applyFilters();
            updateStats();
            showToast(lang === 'ar' ? 'ğŸ§ª ØªÙ… Ø¥Ø¶Ø§ÙØ© 15 Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ' : 'ğŸ§ª Added 15 demo requests');
        }

        // ===== LANGUAGE =====
        function setLang(newLang) {
            lang = newLang;
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';

            document.getElementById('langAr').classList.toggle('active', lang === 'ar');
            document.getElementById('langEn').classList.toggle('active', lang === 'en');

            // Update all data-ar / data-en elements
            document.querySelectorAll('[data-ar]').forEach(el => {
                el.textContent = el.getAttribute(`data-${lang}`) || el.textContent;
            });

            // Update placeholders
            document.querySelectorAll('[data-ar-ph]').forEach(el => {
                el.placeholder = el.getAttribute(`data-${lang}-ph`) || el.placeholder;
            });

            // Update filter select options
            document.querySelectorAll('.filter-select option[data-ar]').forEach(opt => {
                opt.textContent = opt.getAttribute(`data-${lang}`) || opt.textContent;
            });

            // Re-render data
            if (allLeads.length > 0) {
                applyFilters();
                updateStats();
            }
        }

        // ===== TOAST =====
        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // ===== INIT =====
        document.addEventListener('DOMContentLoaded', async () => {
            await initDefaultHash();
            checkAuth();
        });
    </script>
</body>
</html>
